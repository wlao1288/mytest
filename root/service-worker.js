const version="e189124f",cache_name="hcsim-cache-"+version;let assets={};async function cleanResponse(response){const cloned_response=response.clone();return 0==cloned_response.redirected?cloned_response:("body"in cloned_response?Promise.resolve(cloned_response.body):cloned_response.blob()).then(body=>new Response(body,{headers:cloned_response.headers,status:cloned_response.status,statusText:cloned_response.statusText}))}async function cacheAsset(request){console.log("[Service Worker] Searching for resource: "+(request.url||request));var cache,cloned_response,r=await caches.match(request);return r||(r=await fetch(request),cache=await caches.open(cache_name),console.log("[Service Worker] Caching new resource: "+(request.url||request)),cloned_response=await cleanResponse(r),await cache.put(request,cloned_response),r)}self.addEventListener("install",e=>{console.log("[Service Worker] Install"),e.waitUntil(self.skipWaiting())}),self.addEventListener("fetch",e=>{e.respondWith(cacheAsset(e.request))});let cached_apps=[];async function broadcastMessage(mes){var client_list=await self.clients.matchAll();if(client_list)for(const client of client_list)await client.postMessage(mes)}async function checkCachedApps(){var app_name,app_assets;await caches.open(cache_name);for([app_name,app_assets]of Object.entries(assets))if(!cached_apps.includes(app_name)){let completed=!1;for(const asset of app_assets){if(!await caches.match(asset))break;completed=!0}completed&&cached_apps.push(app_name)}await broadcastMessage({type:"complete",content:{cached:cached_apps,version:version}})}function getAssetsList(asset_name){return!asset_name in assets?[]:"ykm"==asset_name?assets.ykm.concat(assets["gwongzau-hc"]):"shandong-hc"==asset_name?assets["shandong-hc"].concat(assets["weihai-hc"]):assets[asset_name]}self.addEventListener("activate",e=>{console.log("[Service Worker] Activate"),e.waitUntil((async()=>{cached_apps=[];for(const key of await caches.keys())key!==cache_name&&await caches.delete(key);await self.clients.claim()})())}),self.addEventListener("message",e=>{e.data&&("download"==e.data.type?(async()=>{await checkCachedApps();let app_assets=[];if("string"==typeof e.data.content){if(cached_apps.includes(e.data.content))return;app_assets=getAssetsList(e.data.content)}else for(const item of e.data.content)cached_apps.includes(item)||(app_assets=app_assets.concat(getAssetsList(item)));if(app_assets){await caches.open(cache_name);let count=0;for(const asset of app_assets)try{await cacheAsset(asset),count++}catch(e){console.log("[Service Worker] Failed to download "+asset)}count==app_assets.length&&("string"==typeof e.data.content?cached_apps.push(e.data.content):cached_apps=cached_apps.concat(e.data.content)),broadcastMessage({type:"complete",content:{cached:cached_apps,version:version}})}})():"clear"==e.data.type?(async()=>{cached_apps=[];for(const key of await caches.keys())await caches.delete(key);for(const client of await self.clients.matchAll())client.postMessage({type:"reload"})})():"check"==e.data.type&&checkCachedApps())}),assets={root:["./","./index.html","./app.css","./manifest.json","./app.js"],tfjkt:["tfjkt/","./tfjkt/index.html","./tfjkt/checkin.html","./tfjkt/app.css","./tfjkt/static/txxck_server.png","./tfjkt/static/message-icon.png","./tfjkt/static/tripcard-img.png","./tfjkt/static/bg9.png","./tfjkt/static/bg8.png","./tfjkt/static/antibody_result_query@2x.png","./tfjkt/static/gou.png","./tfjkt/static/userInfo.png","./tfjkt/static/bg10.png","./tfjkt/static/bg6.png","./tfjkt/static/bg7.png","./tfjkt/static/bg11.png","./tfjkt/static/test.png","./tfjkt/static/code-refresh.svg","./tfjkt/static/bg5.png","./tfjkt/static/bg4.png","./tfjkt/static/bg12.png","./tfjkt/static/scan@2x.png","./tfjkt/static/bg1.png","./tfjkt/static/medical_institution_query@2x.png","./tfjkt/static/consulting@2x.png","./tfjkt/static/bg3.png","./tfjkt/static/bg2.png","./tfjkt/static/familyCode.png","./tfjkt/static/sqbb2.png","./tfjkt/static/vaccinationSuccess@2x.png","./tfjkt/static/scan.png","./tfjkt/static/other_server.png","./tfjkt/manifest.json"],common:["common/","./common/images/telegram-logo.svg","./common/images/logo.jpg","./common/images/codeberg-logo.svg","./common/g-icon.css","./common/nav.css","./common/icons/push_pin.svg","./common/icons/map.svg","./common/icons/place.svg","./common/icons/info.svg","./common/icons/add_box.svg","./common/icons/qr_code.svg","./common/icons/arrow_forward.svg","./common/icons/help.svg","./common/icons/vaccines.svg","./common/icons/download_done.svg","./common/icons/qr_code_scanner.svg","./common/base.js"],tripcard:["tripcard/","./tripcard/index.html","./tripcard/app.css","./tripcard/static/xty0.png","./tripcard/static/gif_green.gif","./tripcard/static/ucload.png","./tripcard/static/dianxin0.png","./tripcard/static/guangdian0.png","./tripcard/static/g2.png","./tripcard/static/yidong0.png","./tripcard/static/img_arrow@2x.png","./tripcard/static/withtext@2x.png","./tripcard/static/liant0.png","./tripcard/manifest.json"]};